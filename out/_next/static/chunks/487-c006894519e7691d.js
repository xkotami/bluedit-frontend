(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[487],{5247:function(e,t,r){"use strict";var s=r(5893),o=r(7294),a=r(1664),n=r.n(a),c=r(1163),i=r(758),l=r.n(i),u=r(4183);t.Z=()=>{let[e,t]=(0,o.useState)(!1),[r,a]=(0,o.useState)(""),i=(0,c.useRouter)();return(0,o.useEffect)(()=>{let e=()=>{let e=(0,u.$8)();t(e),e&&a(localStorage.getItem("userEmail")||"")};e();let r=()=>{e()};return window.addEventListener("storage",r),()=>window.removeEventListener("storage",r)},[]),(0,s.jsx)("header",{className:l().header,children:(0,s.jsx)("div",{children:(0,s.jsxs)("nav",{className:l().nav,children:[(0,s.jsx)(n(),{href:"/",className:l().link,children:"Home"}),e?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n(),{href:"/community",className:l().link,children:"Communities"}),(0,s.jsx)(n(),{href:"/posts/create",className:l().link,children:"Create Post"}),(0,s.jsx)(n(),{href:"/profile",className:l().link,children:"Profile"}),(0,s.jsx)("span",{className:l().userInfo,children:r}),(0,s.jsx)("button",{className:l().logoutButton,onClick:()=>{(0,u.Uh)(),t(!1),a(""),i.push("/")},children:"Logout"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n(),{href:"/community",className:l().link,children:"Communities"}),(0,s.jsx)(n(),{href:"/login",className:l().link,children:"Login"}),(0,s.jsx)(n(),{href:"/signup",className:l().link,children:"Sign Up"})]})]})})})}},4746:function(e,t,r){"use strict";r.d(t,{$8:function(){return o},ON:function(){return c},W4:function(){return i},WY:function(){return u},a$:function(){return m},uv:function(){return l}});let s=()=>localStorage.getItem("authToken"),o=()=>!!s(),a=()=>{let e=localStorage.getItem("userId");return e?parseInt(e):null},n=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=s();return fetch("".concat("https://cne-functions.azurewebsites.net/api").concat(e),{...t,headers:{"Content-Type":"application/json",...r&&{Authorization:"Bearer ".concat(r)},...t.headers}})},c={getCurrentUser:async()=>{try{let e=await n("/user/profile");if(!e.ok)throw Error("Failed to get current user");return await e.json()}catch(r){let e=localStorage.getItem("userId"),t=localStorage.getItem("userEmail");if(!e||!t)throw Error("No user data available");return{id:parseInt(e),email:t,username:t.split("@")[0],points:0,password:""}}}},i={login:async(e,t)=>{try{let r=await fetch("".concat("https://cne-functions.azurewebsites.net/api","/user/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})});if(!r.ok){let e=await r.json();if(console.log("Backend login error:",e),500===r.status){if("ERROR_USER_NOT_FOUND"===e.message)throw Error("User not found");if("ERROR_INVALID_CREDENTIALS"===e.message)throw Error("Invalid email or password");throw Error(e.message||"Login failed")}if(401===r.status)throw Error("Invalid credentials");if(404===r.status)throw Error("User not found");throw Error(e.message||"Login failed")}let s=await r.json();return s.token&&(localStorage.setItem("authToken",s.token),localStorage.setItem("userEmail",s.email),localStorage.setItem("userId",s.id)),{success:!0,data:s}}catch(t){let e="Login failed";return t instanceof Error&&(t.message.includes("ERROR_USER_NOT_FOUND")?e="User not found":t.message.includes("ERROR_INVALID_CREDENTIALS")?e="Invalid email or password":t.message.includes("User not found")?e="User not found":t.message.includes("Invalid")?e="Invalid email or password":t.message&&(e=t.message)),{success:!1,error:e}}},register:async(e,t,r)=>{try{let s=await fetch("".concat("https://cne-functions.azurewebsites.net/api","/user/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,email:t,password:r})});if(!s.ok){let e=await s.json();if(console.log("Backend register error:",e),400===s.status)throw Error(e.message||"User already exists");if(500===s.status&&"ERROR_USER_EXISTS"===e.message)throw Error("User with this email or username already exists");throw Error(e.message||"Registration failed")}let o=await s.json();return o.token&&(localStorage.setItem("authToken",o.token),localStorage.setItem("userEmail",o.email),localStorage.setItem("userId",o.id)),{success:!0,data:o}}catch(t){let e="Registration failed";return t instanceof Error&&(t.message.includes("ERROR_USER_EXISTS")?e="User with this email or username already exists":t.message.includes("User with this email or username already exists")?e="User with this email or username already exists":t.message.includes("User already exists")?e="User with this email or username already exists":t.message.includes("ERROR_INVALID_EMAIL")?e="Please enter a valid email address":t.message&&(e=t.message)),{success:!1,error:e}}},getAllUsers:async()=>{try{let e=await n("/users");if(!e.ok)throw Error("Failed to fetch users");let t=await e.json();return{success:!0,data:t}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to fetch users"}}},getUserById:async e=>{try{let t=await n("/users/".concat(e));if(!t.ok)throw Error("User not found");let r=await t.json();return{success:!0,data:r}}catch(e){return{success:!1,error:e instanceof Error?e.message:"User not found"}}}},l={getAllCommunities:async()=>{try{let e=await n("/communities");if(!e.ok)throw Error("Failed to fetch communities");let t=await e.json();return{success:!0,data:t}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to fetch communities"}}},getCommunityById:async e=>{try{let t=await n("/communities/".concat(e));if(!t.ok)throw Error("Community not found");let r=await t.json();return{success:!0,data:r}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Community not found"}}},createCommunity:async(e,t)=>{try{let r=await n("/communities",{method:"POST",body:JSON.stringify({name:e,description:t})});if(!r.ok){let e=await r.json();throw Error(e.message||"Failed to create community")}let s=await r.json();return{success:!0,data:s}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to create community"}}},getUserCommunities:async()=>{try{let e=await n("/community/user");if(!e.ok)throw Error("Failed to fetch user communities");let t=await e.json();return{success:!0,data:t}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to fetch user communities"}}},joinCommunity:async e=>{try{let t=await n("/community/join/".concat(e),{method:"PUT"});if(!t.ok){let e=await t.json();throw Error(e.message||"Failed to join community")}let r=await t.json();return{success:!0,data:r}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to join community"}}},leaveCommunity:async e=>{try{let t=await n("/community/leave/".concat(e),{method:"PUT"});if(!t.ok){let e=await t.json();throw Error(e.message||"Failed to leave community")}let r=await t.json();return{success:!0,data:r}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to leave community"}}}},u={getAllPosts:async()=>{try{let e=await n("/posts");if(!e.ok)throw Error("Failed to fetch posts");let t=await e.json();return{success:!0,data:t}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to fetch posts"}}},getPostById:async e=>{try{let t=await n("/posts/".concat(e));if(!t.ok)throw Error("Post not found");let r=await t.json();return{success:!0,data:r}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Post not found"}}},getPostsByCommunity:async e=>{try{let t=await n("/post/community/".concat(e));if(!t.ok)throw Error("Failed to fetch community posts");let r=await t.json();return{success:!0,data:r}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to fetch community posts"}}},createPost:async(e,t,r)=>{try{let s=await n("/posts",{method:"POST",body:JSON.stringify({title:e,content:t,communityId:r})});if(!s.ok){let e=await s.json(),t=e.message||e.error||"Failed to create post";throw Error(t)}let o=await s.json();return{success:!0,data:o}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to create post"}}}},m={getAllComments:async()=>{try{let e=await n("/comments");if(!e.ok){let t=await e.json();throw Error(t.message||"Failed to fetch comments")}let t=await e.json();return{success:!0,data:t}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to fetch comments"}}},getCommentsByPost:async e=>{try{let t=await n("/comments/post/".concat(e));if(!t.ok){let e=await t.json();throw Error(e.message||"Failed to fetch comments")}let r=await t.json();return{success:!0,data:r}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to fetch comments"}}},getCommentById:async e=>{try{let t=await n("/comments/".concat(e));if(!t.ok){let e=await t.json();throw Error(e.message||"Comment not found")}let r=await t.json();return{success:!0,data:r}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Comment not found"}}},createComment:async e=>{try{console.log("Creating comment with data:",e);let t=await n("/comments",{method:"POST",body:JSON.stringify({text:e.text,postId:e.postId,userId:e.userId,...e.parentId&&{parentId:e.parentId}})});if(!t.ok){let e=await t.json();throw console.error("Comment creation failed:",t.status,e),Error(e.message||"Failed to create comment")}let r=await t.json();return console.log("Comment created successfully:",r),{success:!0,data:r}}catch(e){return console.error("Error creating comment:",e),{success:!1,error:e instanceof Error?e.message:"Failed to create comment"}}},createReply:async e=>{try{console.log("Creating reply with data:",e);let t=await n("/comments",{method:"POST",body:JSON.stringify({text:e.text,postId:e.postId,userId:e.userId,parentId:e.parentId})});if(!t.ok){let e=await t.json();throw console.error("Reply creation failed:",t.status,e),Error(e.message||"Failed to create reply")}let r=await t.json();return console.log("Reply created successfully:",r),{success:!0,data:r}}catch(e){return console.error("Error creating reply:",e),{success:!1,error:e instanceof Error?e.message:"Failed to create reply"}}},createCommentLegacy:async(e,t)=>{let r=a();return r?m.createComment({text:e,postId:t,userId:r}):{success:!1,error:"User not authenticated"}},createReplyLegacy:async(e,t,r)=>{let s=a();return s?m.createReply({text:e,postId:t,userId:s,parentId:r}):{success:!1,error:"User not authenticated"}},getUserComments:async e=>{try{let t=await n("/user/".concat(e,"/comments"));if(!t.ok){let e=await t.json();throw Error(e.message||"Failed to fetch user comments")}let r=await t.json();return{success:!0,data:r}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to fetch user comments"}}}}},4183:function(e,t,r){"use strict";r.d(t,{$8:function(){return a},Uh:function(){return o},pH:function(){return s}});let s=async(e,t)=>{try{let r=await fetch("".concat("https://cne-functions.azurewebsites.net/api","/user/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})});if(!r.ok){let e=await r.json();if(console.log("Backend error:",e),500===r.status){if("ERROR_USER_NOT_FOUND"===e.message)throw Error("User not found");if("ERROR_INVALID_CREDENTIALS"===e.message)throw Error("Invalid email or password");throw Error(e.message||"Login failed")}if(401===r.status)throw Error("Invalid credentials");if(404===r.status)throw Error("User not found");throw Error(e.message||"Login failed")}let s=await r.json();return s.token&&(localStorage.setItem("authToken",s.token),localStorage.setItem("userEmail",s.email),localStorage.setItem("userId",s.id)),{success:!0,data:{token:s.token,email:s.email,id:s.id}}}catch(t){console.error("Login error:",t);let e="An error occurred during login";return t instanceof Error&&(t.message.includes("ERROR_USER_NOT_FOUND")?e="User not found":t.message.includes("ERROR_INVALID_CREDENTIALS")?e="Invalid email or password":t.message.includes("User not found")?e="User not found":t.message.includes("Invalid")?e="Invalid email or password":t.message&&(e=t.message)),{success:!1,error:e}}},o=()=>{localStorage.removeItem("authToken"),localStorage.removeItem("userEmail"),localStorage.removeItem("userId")},a=()=>!!localStorage.getItem("authToken")},758:function(e){e.exports={header:"header_header__OaHfl",nav:"header_nav__q1mtj",link:"header_link__283Rk",logo1:"header_logo1__bK8E_",logo2:"header_logo2__zy4wK","current-page":"header_current-page__iybsQ"}}}]);